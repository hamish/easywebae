/*
Copyright (c) 2003-2009, CKSource - Frederico Knabben. All rights reserved.
For licensing, see LICENSE.html or http://ckeditor.com/license
*/

(function(){var a={elementNames:[[/^(object|embed|param)$/,'cke:$1']],attributeNames:[[/^on/,'_cke_pa_on']]},b={elementNames:[[/^cke:/,''],[/^\?xml:namespace$/,'']],attributeNames:[[/^_cke_(saved|pa)_/,''],[/^_cke.*/,'']],elements:{embed:function(e){var f=e.parent;if(f&&f.name=='object'){e.attributes.width=f.attributes.width;e.attributes.height=f.attributes.height;}},img:function(e){var f=e.attributes;if(f._cke_saved_src)delete f.src;},a:function(e){var f=e.attributes;if(f._cke_saved_href)delete f.href;}},attributes:{'class':function(e,f){return CKEDITOR.tools.ltrim(e.replace(/(?:^|\s+)cke_[^\s]*/g,''))||false;}}};if(CKEDITOR.env.ie)b.attributes.style=function(e,f){return e.toLowerCase();};var c=/<(?:a|area|img).*?\s((?:href|src)\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|(?:[^ "'>]+)))/gi;function d(e){return e.replace(c,'$& _cke_saved_$1');};CKEDITOR.plugins.add('htmldataprocessor',{requires:['htmlwriter'],init:function(e){var f=e.dataProcessor=new CKEDITOR.htmlDataProcessor();f.writer.forceSimpleAmpersand=e.config.forceSimpleAmpersand;f.dataFilter.addRules(a);f.htmlFilter.addRules(b);}});CKEDITOR.htmlDataProcessor=function(){this.writer=new CKEDITOR.htmlWriter();this.dataFilter=new CKEDITOR.htmlParser.filter();this.htmlFilter=new CKEDITOR.htmlParser.filter();};CKEDITOR.htmlDataProcessor.prototype={toHtml:function(e,f){e=d(e);var g=document.createElement('div');g.innerHTML=e;var h=CKEDITOR.htmlParser.fragment.fromHtml(g.innerHTML,f),i=new CKEDITOR.htmlParser.basicWriter();h.writeHtml(i,this.dataFilter);return i.getHtml(true);},toDataFormat:function(e,f){var g=this.writer,h=CKEDITOR.htmlParser.fragment.fromHtml(e,f);g.reset();h.writeHtml(g,this.htmlFilter);return g.getHtml(true);}};})();CKEDITOR.config.forceSimpleAmpersand=false;
